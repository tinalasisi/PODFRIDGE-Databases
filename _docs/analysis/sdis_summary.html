<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tina Lasisi | Edited: João P. Donadio">
<meta name="dcterms.date" content="2025-08-24">

<title>SDIS Summary Analysis – PODFRIDGE-Databases</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-985aa47af68dae11cd4d235c71fb941e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="../site_libs/tabwid-1.1.3/tabwid.js"></script>

<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<script src="../site_libs/jszip-1.13.6/jszip.min.js"></script>

<link href="../site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">

<script src="../site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>

<link href="../site_libs/dt-ext-colreorder-1.13.6/css/colReorder.dataTables.min.css" rel="stylesheet">

<script src="../site_libs/dt-ext-colreorder-1.13.6/js/dataTables.colReorder.min.js"></script>

<link href="../site_libs/dt-ext-scroller-1.13.6/css/scroller.dataTables.min.css" rel="stylesheet">

<script src="../site_libs/dt-ext-scroller-1.13.6/js/dataTables.scroller.min.js"></script>

<link href="../site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">

<script src="../site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>

<link href="../site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">

<script src="../site_libs/selectize-0.12.0/selectize.min.js"></script>

<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>



<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PODFRIDGE-Databases</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analyses" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analyses</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analyses">    
        <li>
    <a class="dropdown-item" href="../analysis/ndis_scraping.html">
 <span class="dropdown-text">NDIS analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../analysis/sdis_summary.html">
 <span class="dropdown-text">SDIS summary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../analysis/foia_processing.html">
 <span class="dropdown-text">FOIA processing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../analysis/appendix_analysis.html">
 <span class="dropdown-text">Appendix racial analysis</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#import-sdis-data" id="toc-import-sdis-data" class="nav-link" data-scroll-target="#import-sdis-data">Import SDIS data</a></li>
  <li><a href="#arrestee-collection-information" id="toc-arrestee-collection-information" class="nav-link" data-scroll-target="#arrestee-collection-information">Arrestee Collection Information</a>
  <ul class="collapse">
  <li><a href="#adjusting-n_arrestees" id="toc-adjusting-n_arrestees" class="nav-link" data-scroll-target="#adjusting-n_arrestees">Adjusting <code>n_arrestees</code></a></li>
  </ul></li>
  <li><a href="#family-search-policy-status" id="toc-family-search-policy-status" class="nav-link" data-scroll-target="#family-search-policy-status">Family Search Policy Status</a></li>
  <li><a href="#data-availability-overview" id="toc-data-availability-overview" class="nav-link" data-scroll-target="#data-availability-overview">Data Availability Overview</a></li>
  <li><a href="#total-profile-calculations-verification" id="toc-total-profile-calculations-verification" class="nav-link" data-scroll-target="#total-profile-calculations-verification">Total Profile Calculations Verification</a></li>
  <li><a href="#analysis-of-database-totals-and-data-quality-issues" id="toc-analysis-of-database-totals-and-data-quality-issues" class="nav-link" data-scroll-target="#analysis-of-database-totals-and-data-quality-issues">Analysis of Database Totals and Data Quality Issues</a></li>
  <li><a href="#export-enhanced-dataset" id="toc-export-enhanced-dataset" class="nav-link" data-scroll-target="#export-enhanced-dataset">Export Enhanced Dataset</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SDIS Summary Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tina Lasisi | Edited: João P. Donadio </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 24, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This analysis examines State DNA Index System (SDIS) data that includes information reported separately for each state’s DNA database. The data captures key dimensions including:</p>
<ul>
<li>Total size of each state’s DNA database</li>
<li>Whether states collect DNA from arrestees (not just convicted offenders)</li>
<li>Whether states allow familial DNA searching</li>
<li>References to relevant state statutes (from Murphy &amp; Tong appendix)</li>
</ul>
<p>This information provides insight into the variation in DNA database policies, practices, and legal frameworks across U.S. states.</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>Load necessary packages for the analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>required_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyverse"</span>,    <span class="co"># Data manipulation and visualization</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"readr"</span>,      <span class="co"># Reading CSV files</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dplyr"</span>,      <span class="co"># Data manipulation</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyr"</span>,      <span class="co"># Data tidying</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"purrr"</span>,      <span class="co"># Functional programming tools</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ggplot2"</span>,    <span class="co"># Data visualization</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"heatmaply"</span>,  <span class="co"># Interactive heatmaps</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kableExtra"</span>, <span class="co"># Enhanced tables for reporting</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DT"</span>,         <span class="co"># Interactive tables</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"flextable"</span>,  <span class="co"># Flexible tables for reporting</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"maps"</span>,       <span class="co"># Mapping tools</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"here"</span>        <span class="co"># File path management</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to install missing packages</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>install_missing <span class="ot">&lt;-</span> <span class="cf">function</span>(packages) {</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (pkg <span class="cf">in</span> packages) {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(pkg, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Installing missing package:"</span>, pkg))</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">install.packages</span>(pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Install any missing packages</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">install_missing</span>(required_packages)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Load all packages</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readr)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyr)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(purrr)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(heatmaply)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(kableExtra)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(DT)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(flextable)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(maps)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify all packages loaded successfully</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>loaded_packages <span class="ot">&lt;-</span> <span class="fu">sapply</span>(required_packages, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(loaded_packages)) {</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"All packages loaded successfully!"</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"The following packages failed to load: "</span>, </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>          <span class="fu">paste</span>(<span class="fu">names</span>(loaded_packages)[<span class="sc">!</span>loaded_packages], <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="import-sdis-data" class="level2">
<h2 class="anchored" data-anchor-id="import-sdis-data">Import SDIS data</h2>
<p>Load the SDIS dataset and display a glimpse of its structure, including data types, missing values, and unique counts.</p>
<p><strong>Database Columns Definition</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Column</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>state</td>
<td>Name of the U.S. state or jurisdiction</td>
</tr>
<tr class="even">
<td>n_total</td>
<td>Total number of DNA profiles in the state database</td>
</tr>
<tr class="odd">
<td>n_arrestees</td>
<td>Number of arrestee DNA profiles in the database</td>
</tr>
<tr class="even">
<td>n_offenders</td>
<td>Number of convicted offender DNA profiles in the database</td>
</tr>
<tr class="odd">
<td>n_forensic</td>
<td>Number of forensic/crime scene DNA profiles in the database</td>
</tr>
<tr class="even">
<td>arrestee_collection</td>
<td>Whether the state collects DNA from arrestees (‘yes’/‘no’)</td>
</tr>
<tr class="odd">
<td>collection_statute</td>
<td>Citation to the state’s DNA collection statute</td>
</tr>
<tr class="even">
<td>fam_search</td>
<td>Family search policy status (‘permitted’, ‘prohibited’, ‘unspecified’)</td>
</tr>
<tr class="odd">
<td>database_source</td>
<td>URL source for the database statistics</td>
</tr>
<tr class="even">
<td>database_source_year</td>
<td>Year the database statistics were reported</td>
</tr>
<tr class="odd">
<td>verification_comment</td>
<td>Additional notes or comments about data verification</td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Show import code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up path to data file</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">"raw"</span>, <span class="st">"sdis_file"</span>, <span class="st">"sdis_raw.csv"</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the SDIS data</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>sdis_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(data_file)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display data types for each column</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>enhanced_glimpse <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  glimpse_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Column =</span> <span class="fu">names</span>(df),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> <span class="fu">sapply</span>(df, <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="fu">class</span>(x), <span class="at">collapse =</span> <span class="st">", "</span>)),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rows =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing =</span> <span class="fu">sapply</span>(df, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x))),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unique =</span> <span class="fu">sapply</span>(df, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x))),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">First_Values =</span> <span class="fu">sapply</span>(df, <span class="cf">function</span>(x) {</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">is.numeric</span>(x)) {</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">head</span>(x, <span class="dv">3</span>), <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste</span>(<span class="fu">encodeString</span>(<span class="fu">head</span>(<span class="fu">as.character</span>(x), <span class="dv">3</span>)), <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(glimpse_data) <span class="sc">%&gt;%</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_zebra</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_caption</span>(<span class="fu">paste</span>(<span class="st">"Enhanced Data Glimpse:"</span>, <span class="fu">deparse</span>(<span class="fu">substitute</span>(df)))) <span class="sc">%&gt;%</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colformat_num</span>(<span class="at">j =</span> <span class="fu">c</span>(<span class="st">"Rows"</span>, <span class="st">"Missing"</span>, <span class="st">"Unique"</span>), <span class="at">big.mark =</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bg</span>(<span class="at">j =</span> <span class="st">"Missing"</span>, <span class="at">bg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"#FFF3CD"</span>, <span class="st">"transparent"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bg</span>(<span class="at">j =</span> <span class="st">"Unique"</span>, <span class="at">bg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"#FFF3CD"</span>, <span class="st">"transparent"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_footer_lines</span>(<span class="fu">paste</span>(<span class="st">"Data frame dimensions:"</span>, <span class="fu">nrow</span>(df), <span class="st">"rows ×"</span>, <span class="fu">ncol</span>(df), <span class="st">"columns"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ft)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="fu">enhanced_glimpse</span>(sdis_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-5379476a{table-layout:auto;width:100%;}.cl-53678e76{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-53678ea8{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-536db468{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-536df0e0{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df0ea{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df0fe{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df0ff{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df108{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df109{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df112{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df113{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df114{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df11c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df11d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df126{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df127{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df128{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df129{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df130{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df131{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df13a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df13b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df13c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df144{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df145{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df14e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df14f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df150{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df158{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df159{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df162{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df163{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df16c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df16d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df16e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df176{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df177{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df178{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df180{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df181{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df18a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df18b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df18c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df19e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df19f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1a0{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1a8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1a9{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1aa{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1b2{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1b3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1b4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1bc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1bd{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1c6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1c7{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1c8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1d0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df1d1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df220{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df221{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df22a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df22b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-536df22c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-5379476a"><thead><tr style="overflow-wrap:break-word;"><th class="cl-536df0e0"><p class="cl-536db468"><span class="cl-53678e76">Column</span></p></th><th class="cl-536df0ea"><p class="cl-536db468"><span class="cl-53678e76">Type</span></p></th><th class="cl-536df0fe"><p class="cl-536db468"><span class="cl-53678e76">Rows</span></p></th><th class="cl-536df0ff"><p class="cl-536db468"><span class="cl-53678e76">Missing</span></p></th><th class="cl-536df108"><p class="cl-536db468"><span class="cl-53678e76">Unique</span></p></th><th class="cl-536df109"><p class="cl-536db468"><span class="cl-53678e76">First_Values</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-536df112"><p class="cl-536db468"><span class="cl-53678ea8">state</span></p></td><td class="cl-536df113"><p class="cl-536db468"><span class="cl-53678ea8">character</span></p></td><td class="cl-536df114"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df11c"><p class="cl-536db468"><span class="cl-53678ea8">0</span></p></td><td class="cl-536df11d"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df126"><p class="cl-536db468"><span class="cl-53678ea8">Alabama, Alaska, Arizona</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-536df127"><p class="cl-536db468"><span class="cl-53678ea8">n_total</span></p></td><td class="cl-536df128"><p class="cl-536db468"><span class="cl-53678ea8">numeric</span></p></td><td class="cl-536df129"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df130"><p class="cl-536db468"><span class="cl-53678ea8">23</span></p></td><td class="cl-536df131"><p class="cl-536db468"><span class="cl-53678ea8">28</span></p></td><td class="cl-536df13a"><p class="cl-536db468"><span class="cl-53678ea8">360000, 79146, NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-536df13b"><p class="cl-536db468"><span class="cl-53678ea8">n_arrestees</span></p></td><td class="cl-536df13c"><p class="cl-536db468"><span class="cl-53678ea8">numeric</span></p></td><td class="cl-536df144"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df145"><p class="cl-536db468"><span class="cl-53678ea8">27</span></p></td><td class="cl-536df14e"><p class="cl-536db468"><span class="cl-53678ea8">8</span></p></td><td class="cl-536df14f"><p class="cl-536db468"><span class="cl-53678ea8">NA, 52149, NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-536df150"><p class="cl-536db468"><span class="cl-53678ea8">n_offenders</span></p></td><td class="cl-536df158"><p class="cl-536db468"><span class="cl-53678ea8">numeric</span></p></td><td class="cl-536df159"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df162"><p class="cl-536db468"><span class="cl-53678ea8">34</span></p></td><td class="cl-536df163"><p class="cl-536db468"><span class="cl-53678ea8">17</span></p></td><td class="cl-536df16c"><p class="cl-536db468"><span class="cl-53678ea8">NA, 26997, NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-536df16d"><p class="cl-536db468"><span class="cl-53678ea8">n_forensic</span></p></td><td class="cl-536df16e"><p class="cl-536db468"><span class="cl-53678ea8">numeric</span></p></td><td class="cl-536df176"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df162"><p class="cl-536db468"><span class="cl-53678ea8">39</span></p></td><td class="cl-536df163"><p class="cl-536db468"><span class="cl-53678ea8">12</span></p></td><td class="cl-536df177"><p class="cl-536db468"><span class="cl-53678ea8">NA, 3866, NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-536df127"><p class="cl-536db468"><span class="cl-53678ea8">arrestee_collection</span></p></td><td class="cl-536df128"><p class="cl-536db468"><span class="cl-53678ea8">character</span></p></td><td class="cl-536df129"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df178"><p class="cl-536db468"><span class="cl-53678ea8">0</span></p></td><td class="cl-536df131"><p class="cl-536db468"><span class="cl-53678ea8">2</span></p></td><td class="cl-536df13a"><p class="cl-536db468"><span class="cl-53678ea8">yes, yes, yes</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-536df180"><p class="cl-536db468"><span class="cl-53678ea8">collection_statute</span></p></td><td class="cl-536df181"><p class="cl-536db468"><span class="cl-53678ea8">character</span></p></td><td class="cl-536df18a"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df18b"><p class="cl-536db468"><span class="cl-53678ea8">0</span></p></td><td class="cl-536df18c"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df19e"><p class="cl-536db468"><span class="cl-53678ea8">Ala. Code Sec.36-18-25, AK Stat Sec.44.41.035 (2014), AZ Rev Stat Sec.13-610 (2016)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-536df150"><p class="cl-536db468"><span class="cl-53678ea8">fam_search</span></p></td><td class="cl-536df158"><p class="cl-536db468"><span class="cl-53678ea8">character</span></p></td><td class="cl-536df159"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df19f"><p class="cl-536db468"><span class="cl-53678ea8">0</span></p></td><td class="cl-536df163"><p class="cl-536db468"><span class="cl-53678ea8">3</span></p></td><td class="cl-536df16c"><p class="cl-536db468"><span class="cl-53678ea8">unspecified, unspecified, unspecified</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-536df180"><p class="cl-536db468"><span class="cl-53678ea8">database_source</span></p></td><td class="cl-536df181"><p class="cl-536db468"><span class="cl-53678ea8">character</span></p></td><td class="cl-536df18a"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df1a0"><p class="cl-536db468"><span class="cl-53678ea8">20</span></p></td><td class="cl-536df18c"><p class="cl-536db468"><span class="cl-53678ea8">31</span></p></td><td class="cl-536df19e"><p class="cl-536db468"><span class="cl-53678ea8">https://adfs.alabama.gov/services/fb/fb-statistics, https://dps.alaska.gov/Statewide/CrimeLab/Forensic-Biology/DNA, &lt;NA&gt;</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-536df1a8"><p class="cl-536db468"><span class="cl-53678ea8">database_source_year</span></p></td><td class="cl-536df1a9"><p class="cl-536db468"><span class="cl-53678ea8">numeric</span></p></td><td class="cl-536df1aa"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df1b2"><p class="cl-536db468"><span class="cl-53678ea8">20</span></p></td><td class="cl-536df1b3"><p class="cl-536db468"><span class="cl-53678ea8">11</span></p></td><td class="cl-536df1b4"><p class="cl-536db468"><span class="cl-53678ea8">2024, 2024, NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-536df1bc"><p class="cl-536db468"><span class="cl-53678ea8">verification_comment</span></p></td><td class="cl-536df1bd"><p class="cl-536db468"><span class="cl-53678ea8">character</span></p></td><td class="cl-536df1c6"><p class="cl-536db468"><span class="cl-53678ea8">50</span></p></td><td class="cl-536df1c7"><p class="cl-536db468"><span class="cl-53678ea8">35</span></p></td><td class="cl-536df1c8"><p class="cl-536db468"><span class="cl-53678ea8">16</span></p></td><td class="cl-536df1d0"><p class="cl-536db468"><span class="cl-53678ea8">Alabama Department of Forensic Sciences notes that as of January&nbsp;2024 the state DNA database contains about 360,000 convicted offender and arrestee profileshttps://adfs.alabama.gov/services/fb/fb-statistics#:~:text=The%20DNA%20Databank%20laboratory%20receives,DNA%20profiles%20are%20being%20searched., Alaska DPS crime‑lab CODIS metrics (Feb&nbsp;2024) list 52,149 arrestee profiles, 26,997 convicted offender profiles and 3,866 forensic profiles in the Alaska state DNA databasehttps://dps.alaska.gov/Statewide/CrimeLab/Forensic-Biology/DNA#:~:text=CODIS%20Metrics%20as%20of%C2%A0February%202024,Offenders%20in%20database%2026%2C997%2015%2C268%2C774., &lt;NA&gt;</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-536df1d1"><p class="cl-536db468"><span class="cl-53678ea8">Data frame dimensions: 50 rows × 11 columns</span></p></td></tr></tfoot></table></div>
</div>
</div>
</section>
<section id="arrestee-collection-information" class="level2">
<h2 class="anchored" data-anchor-id="arrestee-collection-information">Arrestee Collection Information</h2>
<p>In the United States, the collection of DNA from individuals upon arrest, prior to any conviction, is a significant law enforcement practice with complex legal and ethical dimensions.</p>
<p>The following map and table illustrate the current patchwork of state laws governing this practice.</p>
<div class="cell">
<details class="code-fold">
<summary>Show arrestee collection visualization code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary data for arrestee collection</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>arrestee_summary <span class="ot">&lt;-</span> sdis_data <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(arrestee_collection) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">states =</span> <span class="fu">list</span>(state),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get US state map data</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>us_states <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"state"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare map data</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>map_data <span class="ot">&lt;-</span> sdis_data <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">tolower</span>(state)) <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(us_states, <span class="at">by =</span> <span class="st">"region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(arrestee_collection))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1: US Map Visualization</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>map_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(map_data, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> arrestee_collection)) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"yes"</span> <span class="ot">=</span> <span class="st">"#2E86AB"</span>,      <span class="co"># Blue for collecting states</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">"no"</span> <span class="ot">=</span> <span class="st">"#FF6B6B"</span>       <span class="co"># Red for non-collecting states</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Collects DNA from Arrestees"</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"DNA Collection from Arrestees by State"</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"States that collect DNA samples from individuals upon arrest"</span>,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Source: SDIS Database Analysis"</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Create detailed summary table</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> arrestee_summary <span class="sc">%&gt;%</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_list =</span> <span class="fu">map_chr</span>(states, <span class="sc">~</span><span class="fu">paste</span>(.x, <span class="at">collapse =</span> <span class="st">", "</span>)),</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> <span class="fu">round</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Status =</span> arrestee_collection, <span class="at">Count =</span> count, <span class="at">Percentage =</span> percentage, <span class="at">States =</span> state_list)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the visualizations</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(map_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sdis_summary_files/figure-html/arrestee-collection-visualization-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show arrestee collection visualization code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a nice flextable for the report</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(summary_table) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_zebra</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Arrestee DNA Collection Status by State"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="st">"Status"</span>, <span class="at">bg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="st">"yes"</span>, <span class="st">"#2E86AB"</span>, <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="st">"no"</span>, <span class="st">"#FF6B6B"</span>, <span class="st">"#CCCCCC"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">j =</span> <span class="st">"Status"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="st">"Status"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">part =</span> <span class="st">"all"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>ft</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-541d5d50{}.cl-540a3fa4{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-540a3fb8{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-540a3fb9{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-540fd1b2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5410004c{width:0.752in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54100056{width:0.726in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54100057{width:1.109in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54100060{width:24.24in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5410006a{width:0.752in;background-color:rgba(46, 134, 171, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5410006b{width:0.726in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5410006c{width:1.109in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5410006d{width:24.24in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54100074{width:0.752in;background-color:rgba(255, 107, 107, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54100075{width:0.726in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54100076{width:1.109in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-54100077{width:24.24in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-541d5d50"><thead><tr style="overflow-wrap:break-word;"><th class="cl-5410004c"><p class="cl-540fd1b2"><span class="cl-540a3fa4">Status</span></p></th><th class="cl-54100056"><p class="cl-540fd1b2"><span class="cl-540a3fa4">Count</span></p></th><th class="cl-54100057"><p class="cl-540fd1b2"><span class="cl-540a3fa4">Percentage</span></p></th><th class="cl-54100060"><p class="cl-540fd1b2"><span class="cl-540a3fa4">States</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-5410006a"><p class="cl-540fd1b2"><span class="cl-540a3fb8">yes</span></p></td><td class="cl-5410006b"><p class="cl-540fd1b2"><span class="cl-540a3fb9">33</span></p></td><td class="cl-5410006c"><p class="cl-540fd1b2"><span class="cl-540a3fb9">66</span></p></td><td class="cl-5410006d"><p class="cl-540fd1b2"><span class="cl-540a3fb9">Alabama, Alaska, Arizona, Arkansas, California, Colorado, Connecticut, Florida, Georgia, Illinois, Indiana, Kansas, Louisiana, Maryland, Michigan, Minnesota, Mississippi, Missouri, Nevada, New Jersey, New Mexico, North Carolina, North Dakota, Ohio, Oklahoma, Rhode Island, South Carolina, South Dakota, Tennessee, Texas, Utah, Virginia, Wisconsin</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-54100074"><p class="cl-540fd1b2"><span class="cl-540a3fb8">no</span></p></td><td class="cl-54100075"><p class="cl-540fd1b2"><span class="cl-540a3fb9">17</span></p></td><td class="cl-54100076"><p class="cl-540fd1b2"><span class="cl-540a3fb9">34</span></p></td><td class="cl-54100077"><p class="cl-540fd1b2"><span class="cl-540a3fb9">Delaware, Hawaii, Idaho, Iowa, Kentucky, Maine, Massachusetts, Montana, Nebraska, New Hampshire, New York, Oregon, Pennsylvania, Vermont, Washington, West Virginia, Wyoming</span></p></td></tr></tbody></table></div>
</div>
</div>
<section id="adjusting-n_arrestees" class="level3">
<h3 class="anchored" data-anchor-id="adjusting-n_arrestees">Adjusting <code>n_arrestees</code></h3>
<ul>
<li><p>Adjust the dataset to ensure consistency in arrestee DNA collection reporting.</p></li>
<li><p>Setting <code>n_arrestees</code> to 0 for states that do not collect arrestee DNA, even if they report non-zero values.</p></li>
<li><p>Removed the <code>arrestee_colection</code> column after adjustments were made.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show pre-processing code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a copy of the data for processing</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sdis_data_processed <span class="ot">&lt;-</span> sdis_data</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count states affected by this adjustment</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>states_with_no_collection <span class="ot">&lt;-</span> sdis_data_processed <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(arrestee_collection <span class="sc">==</span> <span class="st">'no'</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>states_to_adjust <span class="ot">&lt;-</span> states_with_no_collection <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(n_arrestees) <span class="sc">&amp;</span> n_arrestees <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(states_to_adjust) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"States with arrestee_collection='no' but non-zero n_arrestees values:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(states_to_adjust)) {</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    state <span class="ot">&lt;-</span> states_to_adjust[i, ]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"  • "</span>, state<span class="sc">$</span>state, <span class="st">": n_arrestees = "</span>, <span class="fu">format</span>(state<span class="sc">$</span>n_arrestees, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Set n_arrestees to 0 for states that don't collect arrestee DNA</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>sdis_data_processed <span class="ot">&lt;-</span> sdis_data_processed <span class="sc">%&gt;%</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_arrestees =</span> <span class="fu">ifelse</span>(arrestee_collection <span class="sc">==</span> <span class="st">'no'</span>, <span class="dv">0</span>, n_arrestees))  <span class="sc">%&gt;%</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>arrestee_collection)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Adjusted N_arrestees to 0 for"</span>, <span class="fu">nrow</span>(states_with_no_collection), </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>          <span class="st">"states that do not collect arrestee DNA:</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(states_with_no_collection<span class="sc">$</span>state)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Use processed data for all subsequent analyses</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>sdis_data <span class="ot">&lt;-</span> sdis_data_processed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Adjusted N_arrestees to 0 for 17 states that do not collect arrestee DNA:
 [1] "Delaware"      "Hawaii"        "Idaho"         "Iowa"         
 [5] "Kentucky"      "Maine"         "Massachusetts" "Montana"      
 [9] "Nebraska"      "New Hampshire" "New York"      "Oregon"       
[13] "Pennsylvania"  "Vermont"       "Washington"    "West Virginia"
[17] "Wyoming"      </code></pre>
</div>
</div>
</section>
</section>
<section id="family-search-policy-status" class="level2">
<h2 class="anchored" data-anchor-id="family-search-policy-status">Family Search Policy Status</h2>
<p>Familial DNA searching is an advanced forensic technique that uses partial DNA matches to identify potential relatives of an unknown suspect in a criminal database.</p>
<p>The following visualization maps the current patchwork of state policies (‘permitted’, ‘prohibited’, ‘unspecified’).</p>
<div class="cell">
<details class="code-fold">
<summary>Show family search policy visualization code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary data for family search policies</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>family_search_summary <span class="ot">&lt;-</span> sdis_data <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fam_search =</span> <span class="fu">factor</span>(fam_search, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"permitted"</span>, <span class="st">"prohibited"</span>, <span class="st">"unspecified"</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Permitted"</span>, <span class="st">"Prohibited"</span>, <span class="st">"Unspecified"</span>)),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fam_search_simple =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      fam_search <span class="sc">==</span> <span class="st">"Permitted"</span> <span class="sc">~</span> <span class="st">"Permitted"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      fam_search <span class="sc">==</span> <span class="st">"Prohibited"</span> <span class="sc">~</span> <span class="st">"Prohibited"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unspecified/No Policy"</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fam_search, fam_search_simple) <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">states =</span> <span class="fu">list</span>(state),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Get complete data for mapping (include states with missing data)</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>all_states_map <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"state"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_name =</span> <span class="fu">str_to_title</span>(region),</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_data =</span> state_name <span class="sc">%in%</span> sdis_data<span class="sc">$</span>state</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare map data for family search policies</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>family_search_map_data <span class="ot">&lt;-</span> sdis_data <span class="sc">%&gt;%</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">region =</span> <span class="fu">tolower</span>(state)) <span class="sc">%&gt;%</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(<span class="fu">map_data</span>(<span class="st">"state"</span>), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"region"</span> <span class="ot">=</span> <span class="st">"region"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(fam_search))</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1: US Map Visualization</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>family_map_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(family_search_map_data, </span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> fam_search)) <span class="sc">+</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">"permitted"</span> <span class="ot">=</span> <span class="st">"#2E86AB"</span>,      <span class="co"># Blue for permitted</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">"prohibited"</span> <span class="ot">=</span> <span class="st">"#F9A03F"</span>,   <span class="co"># Orange for prohibited</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">"unspecified"</span> <span class="ot">=</span> <span class="st">"#CCCCCC"</span>  <span class="co"># Light gray for unspecified</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Familial Search Policy"</span>,</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">drop =</span> <span class="cn">FALSE</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Familial DNA Search Policies by State"</span>,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"State policies regarding familial DNA searching in databases"</span>,</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Source: SDIS Database Analysis"</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the visualizations</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(family_map_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sdis_summary_files/figure-html/family-search-visualization-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show family search policy visualization code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a comprehensive summary table</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>summary_table_data <span class="ot">&lt;-</span> family_search_summary <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_list =</span> <span class="fu">map_chr</span>(states, <span class="sc">~</span><span class="fu">paste</span>(.x, <span class="at">collapse =</span> <span class="st">", "</span>)),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> <span class="fu">round</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">icon =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      fam_search <span class="sc">==</span> <span class="st">"Allowed"</span> <span class="sc">~</span> <span class="st">"🔵"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      fam_search <span class="sc">==</span> <span class="st">"Restricted"</span> <span class="sc">~</span> <span class="st">"🟠"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"⚪"</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Icon =</span> icon, <span class="at">Policy =</span> fam_search, <span class="at">Count =</span> count, <span class="at">Percentage =</span> percentage, <span class="at">States =</span> state_list)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a nice flextable for the report</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(summary_table_data) <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_zebra</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Familial DNA Search Policy Status by State"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">j =</span> <span class="st">"States"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bg</span>(<span class="at">j =</span> <span class="st">"Policy"</span>, <span class="at">bg =</span> <span class="cf">function</span>(x) {</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">case_when</span>(</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">==</span> <span class="st">"Permitted"</span> <span class="sc">~</span> <span class="st">"#2E86AB"</span>,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">==</span> <span class="st">"Prohibited"</span> <span class="sc">~</span> <span class="st">"#F9A03F"</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"#CCCCCC"</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">color</span>(<span class="at">j =</span> <span class="st">"Policy"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">j =</span> <span class="st">"Policy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="st">"States"</span>, <span class="at">width =</span> <span class="dv">3</span>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>ft</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-551b9708{}.cl-54f649ee{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-54f64a02{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-54f64a0c{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-5500fbd2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5500fbe6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-55016de2{width:0.599in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016df6{width:1.083in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016df7{width:0.726in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e00{width:1.109in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e0a{width:3in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e0b{width:0.599in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e14{width:1.083in;background-color:rgba(204, 204, 204, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e15{width:0.726in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e1e{width:1.109in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e28{width:3in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e29{width:0.599in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e2a{width:1.083in;background-color:rgba(46, 134, 171, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e32{width:0.726in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e33{width:1.109in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e34{width:3in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e3c{width:0.599in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e3d{width:1.083in;background-color:rgba(249, 160, 63, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e3e{width:0.726in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e46{width:1.109in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-55016e47{width:3in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-551b9708"><thead><tr style="overflow-wrap:break-word;"><th class="cl-55016de2"><p class="cl-5500fbd2"><span class="cl-54f649ee">Icon</span></p></th><th class="cl-55016df6"><p class="cl-5500fbd2"><span class="cl-54f649ee">Policy</span></p></th><th class="cl-55016df7"><p class="cl-5500fbd2"><span class="cl-54f649ee">Count</span></p></th><th class="cl-55016e00"><p class="cl-5500fbd2"><span class="cl-54f649ee">Percentage</span></p></th><th class="cl-55016e0a"><p class="cl-5500fbd2"><span class="cl-54f649ee">States</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-55016e0b"><p class="cl-5500fbd2"><span class="cl-54f64a02">⚪</span></p></td><td class="cl-55016e14"><p class="cl-5500fbd2"><span class="cl-54f64a0c">Unspecified</span></p></td><td class="cl-55016e15"><p class="cl-5500fbd2"><span class="cl-54f64a02">37</span></p></td><td class="cl-55016e1e"><p class="cl-5500fbd2"><span class="cl-54f64a02">74</span></p></td><td class="cl-55016e28"><p class="cl-5500fbe6"><span class="cl-54f64a02">Alabama, Alaska, Arizona, Connecticut, Delaware, Georgia, Hawaii, Idaho, Illinois, Indiana, Iowa, Kansas, Kentucky, Louisiana, Maine, Massachusetts, Minnesota, Mississippi, Missouri, Nebraska, Nevada, New Hampshire, New Jersey, New Mexico, North Carolina, North Dakota, Ohio, Oklahoma, Oregon, Pennsylvania, Rhode Island, South Carolina, South Dakota, Tennessee, Vermont, Washington, West Virginia</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-55016e29"><p class="cl-5500fbd2"><span class="cl-54f64a02">⚪</span></p></td><td class="cl-55016e2a"><p class="cl-5500fbd2"><span class="cl-54f64a0c">Permitted</span></p></td><td class="cl-55016e32"><p class="cl-5500fbd2"><span class="cl-54f64a02">12</span></p></td><td class="cl-55016e33"><p class="cl-5500fbd2"><span class="cl-54f64a02">24</span></p></td><td class="cl-55016e34"><p class="cl-5500fbe6"><span class="cl-54f64a02">Arkansas, California, Colorado, Florida, Michigan, Montana, New York, Texas, Utah, Virginia, Wisconsin, Wyoming</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-55016e3c"><p class="cl-5500fbd2"><span class="cl-54f64a02">⚪</span></p></td><td class="cl-55016e3d"><p class="cl-5500fbd2"><span class="cl-54f64a0c">Prohibited</span></p></td><td class="cl-55016e3e"><p class="cl-5500fbd2"><span class="cl-54f64a02">1</span></p></td><td class="cl-55016e46"><p class="cl-5500fbd2"><span class="cl-54f64a02">2</span></p></td><td class="cl-55016e47"><p class="cl-5500fbe6"><span class="cl-54f64a02">Maryland</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="data-availability-overview" class="level2">
<h2 class="anchored" data-anchor-id="data-availability-overview">Data Availability Overview</h2>
<p>Assess the completeness of data across states, including which states are missing and the availability of key fields.</p>
<div class="cell">
<details class="code-fold">
<summary>Show overview code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify states present in the dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>states_in_data <span class="ot">&lt;-</span> <span class="fu">unique</span>(sdis_data<span class="sc">$</span>state) <span class="sc">%&gt;%</span> <span class="fu">sort</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if all 50 states are represented</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>all_states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Alabama'</span>, <span class="st">'Alaska'</span>, <span class="st">'Arizona'</span>, <span class="st">'Arkansas'</span>, <span class="st">'California'</span>, <span class="st">'Colorado'</span>, <span class="st">'Connecticut'</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Delaware'</span>, <span class="st">'Florida'</span>, <span class="st">'Georgia'</span>, <span class="st">'Hawaii'</span>, <span class="st">'Idaho'</span>, <span class="st">'Illinois'</span>, <span class="st">'Indiana'</span>, <span class="st">'Iowa'</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Kansas'</span>, <span class="st">'Kentucky'</span>, <span class="st">'Louisiana'</span>, <span class="st">'Maine'</span>, <span class="st">'Maryland'</span>, <span class="st">'Massachusetts'</span>, <span class="st">'Michigan'</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Minnesota'</span>, <span class="st">'Mississippi'</span>, <span class="st">'Missouri'</span>, <span class="st">'Montana'</span>, <span class="st">'Nebraska'</span>, <span class="st">'Nevada'</span>, <span class="st">'New Hampshire'</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">'New Jersey'</span>, <span class="st">'New Mexico'</span>, <span class="st">'New York'</span>, <span class="st">'North Carolina'</span>, <span class="st">'North Dakota'</span>, <span class="st">'Ohio'</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Oklahoma'</span>, <span class="st">'Oregon'</span>, <span class="st">'Pennsylvania'</span>, <span class="st">'Rhode Island'</span>, <span class="st">'South Carolina'</span>, <span class="st">'South Dakota'</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Tennessee'</span>, <span class="st">'Texas'</span>, <span class="st">'Utah'</span>, <span class="st">'Vermont'</span>, <span class="st">'Virginia'</span>, <span class="st">'Washington'</span>, <span class="st">'West Virginia'</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Wisconsin'</span>, <span class="st">'Wyoming'</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>missing_states <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(all_states, states_in_data)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(missing_states) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Missing states:"</span>, <span class="fu">paste</span>(missing_states, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">All 50 states are represented in the dataset</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess data completeness for each state</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Improved heatmap with enhanced visualization</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>data_availability <span class="ot">&lt;-</span> sdis_data <span class="sc">%&gt;%</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>state) <span class="sc">%&gt;%</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data_availability) <span class="ot">&lt;-</span> <span class="fu">unique</span>(sdis_data<span class="sc">$</span>state)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate visualization of data completeness</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>key_fields <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'n_total'</span>, <span class="st">'n_arrestees'</span>, <span class="st">'n_offenders'</span>, <span class="st">'n_forensic'</span>)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to include only key fields that exist in the data</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>available_key_fields <span class="ot">&lt;-</span> <span class="fu">intersect</span>(key_fields, <span class="fu">names</span>(data_availability))</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(available_key_fields) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  availability_subset <span class="ot">&lt;-</span> data_availability[, available_key_fields, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  availability_binary <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">ifelse</span>(availability_subset <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create heatmap data in long format</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  heatmap_long <span class="ot">&lt;-</span> availability_binary <span class="sc">%&gt;%</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"state"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>state, <span class="at">names_to =</span> <span class="st">"field"</span>, <span class="at">values_to =</span> <span class="st">"available"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">state =</span> <span class="fu">factor</span>(state, <span class="at">levels =</span> <span class="fu">rownames</span>(availability_binary)),</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">state =</span> <span class="fu">factor</span>(state, <span class="at">levels =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(state), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">field =</span> <span class="fu">factor</span>(field, <span class="at">levels =</span> available_key_fields),</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create labels with different symbols</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>        available <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"✓"</span>,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>        available <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"!"</span>,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Color coding for different values</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill_color =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>        available <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Available"</span>,</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>        available <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Missing"</span>,</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the enhanced heatmap</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heatmap_long, <span class="fu">aes</span>(<span class="at">x =</span> field, <span class="at">y =</span> state, <span class="at">fill =</span> fill_color)) <span class="sc">+</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">height =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">color =</span> fill_color), </span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">vjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Available"</span> <span class="ot">=</span> <span class="st">"#2E86AB"</span>,</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Missing"</span> <span class="ot">=</span> <span class="st">"#FF6B6B"</span>,</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unknown"</span> <span class="ot">=</span> <span class="st">"#f0f0f0"</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Available"</span> <span class="ot">=</span> <span class="st">"white"</span>,</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Missing"</span> <span class="ot">=</span> <span class="st">"white"</span>,</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unknown"</span> <span class="ot">=</span> <span class="st">"gray30"</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Data Availability Heatmap by State"</span>,</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"✓ = Data available | ! = Data missing (0 values)"</span>,</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Data Status"</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x.top =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>), </span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">vjust =</span> <span class="dv">0</span>),</span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(),</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x.top =</span> <span class="fu">element_line</span>()</span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">position =</span> <span class="st">"top"</span>)</span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"No key fields available for heatmap visualization"</span>)</span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sdis_summary_files/figure-html/overview-data-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show overview code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data coverage summary</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data field coverage across states:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>key_fields <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'n_total'</span>, <span class="st">'n_arrestees'</span>, <span class="st">'n_offenders'</span>, <span class="st">'n_forensic'</span>, <span class="st">'fam_search'</span>, <span class="st">'collection_statute'</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> key_fields) {</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (col <span class="sc">%in%</span> <span class="fu">names</span>(sdis_data)) {</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    states_with_data <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(sdis_data[[col]]))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    coverage_pct <span class="ot">&lt;-</span> states_with_data <span class="sc">/</span> <span class="fu">length</span>(states_in_data) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(col, <span class="st">": "</span>, states_with_data, <span class="st">" states ("</span>, <span class="fu">round</span>(coverage_pct, <span class="dv">1</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
All 50 states are represented in the dataset

Data field coverage across states:
n_total: 27 states (54%)
n_arrestees: 23 states (46%)
n_offenders: 16 states (32%)
n_forensic: 11 states (22%)
fam_search: 50 states (100%)
collection_statute: 50 states (100%)</code></pre>
</div>
</div>
</section>
<section id="total-profile-calculations-verification" class="level2">
<h2 class="anchored" data-anchor-id="total-profile-calculations-verification">Total Profile Calculations Verification</h2>
<p>This section examines states reporting n_total alongside component counts to determine whether totals represent:</p>
<ol type="1">
<li><p>Sum of all profile types including forensic (n_arrestees + n_offenders + n_forensic)</p></li>
<li><p>Sum of combined profiles only (n_arrestees + n_offenders)</p></li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show calculations code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify states with n_total and at least one component count</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>states_with_totals <span class="ot">&lt;-</span> sdis_data <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(n_total)) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sum_all =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., n_arrestees, n_offenders, n_forensic), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sum_arrestees_offenders =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., n_arrestees, n_offenders), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if all components are available</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_components_available =</span> <span class="sc">!</span><span class="fu">is.na</span>(n_arrestees) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n_offenders) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n_forensic),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">both_arrestees_offenders =</span> <span class="sc">!</span><span class="fu">is.na</span>(n_arrestees) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n_offenders)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Check matches with tolerance</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>tolerance <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>states_with_totals <span class="ot">&lt;-</span> states_with_totals <span class="sc">%&gt;%</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">matches_combined_forensic =</span> <span class="fu">ifelse</span>(</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>      all_components_available,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(n_total <span class="sc">-</span> sum_all) <span class="sc">&lt;=</span> tolerance,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">FALSE</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">matches_combined =</span> <span class="fu">ifelse</span>(</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      both_arrestees_offenders,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">abs</span>(n_total <span class="sc">-</span> sum_arrestees_offenders) <span class="sc">&lt;=</span> tolerance) <span class="sc">&amp;</span> </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        (n_arrestees <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">FALSE</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to states with at least one component count</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>has_components <span class="ot">&lt;-</span> states_with_totals <span class="sc">%&gt;%</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(n_arrestees) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(n_offenders) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(n_forensic))</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"States with n_total and component data:"</span>, <span class="fu">nrow</span>(has_components), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Total calculation patterns:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorize states</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>includes_all <span class="ot">&lt;-</span> has_components <span class="sc">%&gt;%</span> <span class="fu">filter</span>(matches_combined_forensic) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(state)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>forensic_only <span class="ot">&lt;-</span> has_components <span class="sc">%&gt;%</span> <span class="fu">filter</span>(matches_combined <span class="sc">&amp;</span> <span class="sc">!</span>matches_combined_forensic) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(state)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>neither <span class="ot">&lt;-</span> has_components <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>matches_combined_forensic <span class="sc">&amp;</span> <span class="sc">!</span>matches_combined) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(state)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(includes_all) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">n_total matches combined profiles with forensic (arrestees + offenders + forensic):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (state <span class="cf">in</span> includes_all) {</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"  •"</span>, state, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">States where n_total matches the sum of arrestees + offenders + forensic: None</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(forensic_only) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">States where n_total includes combined profiles only (arrestees + offenders):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (state <span class="cf">in</span> forensic_only) {</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"  •"</span>, state, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(neither) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">States where n_total does not match calculated sums:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (state <span class="cf">in</span> neither) {</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    state_data <span class="ot">&lt;-</span> has_components <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="sc">!!</span>state)</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"  • "</span>, state, <span class="st">":</span><span class="sc">\n</span><span class="st"> n_total="</span>, <span class="fu">format</span>(state_data<span class="sc">$</span>n_total, <span class="at">big.mark =</span> <span class="st">","</span>), </span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>               <span class="st">"</span><span class="sc">\n</span><span class="st"> Sum_all="</span>, <span class="fu">format</span>(state_data<span class="sc">$</span>sum_all, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>               <span class="st">"</span><span class="sc">\n</span><span class="st"> Sum_arrestees_offenders ="</span>, <span class="fu">format</span>(state_data<span class="sc">$</span>sum_arrestees_offenders, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>))</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Display detailed breakdown</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Detailed breakdown:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>has_components <span class="sc">%&gt;%</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, n_total, n_arrestees, n_offenders, n_forensic, matches_combined_forensic, matches_combined) <span class="sc">%&gt;%</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="st">""</span>, <span class="fu">format</span>(., <span class="at">big.mark =</span> <span class="st">","</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>States with n_total and component data: 17 

Total calculation patterns:

States where n_total matches the sum of arrestees + offenders + forensic: None

States where n_total includes combined profiles only (arrestees + offenders):
  • Alaska 
  • North Carolina 
  • Rhode Island 
  • Tennessee 

States where n_total does not match calculated sums:
  • California:
 n_total=3,365,402
 Sum_all=167,053
 Sum_arrestees_offenders =0

  • Connecticut:
 n_total=127,940
 Sum_all=151,140
 Sum_arrestees_offenders =127,940

  • Georgia:
 n_total=347,145
 Sum_all=347,145
 Sum_arrestees_offenders =324,864

  • Idaho:
 n_total=39,000
 Sum_all=39,000
 Sum_arrestees_offenders =39,000

  • Illinois:
 n_total=689,297
 Sum_all=759,224
 Sum_arrestees_offenders =689,297

  • Indiana:
 n_total=449,000
 Sum_all=470,400
 Sum_arrestees_offenders =448,000

  • Minnesota:
 n_total=180,000
 Sum_all=180,000
 Sum_arrestees_offenders =180,000

  • Missouri:
 n_total=4e+05
 Sum_all=386,000
 Sum_arrestees_offenders =386,000

  • Montana:
 n_total=32,284
 Sum_all=33,162
 Sum_arrestees_offenders =32,284

  • South Carolina:
 n_total=175,629
 Sum_all=11,127
 Sum_arrestees_offenders =0

  • Texas:
 n_total=1,308,774
 Sum_all=1,308,774
 Sum_arrestees_offenders =1,308,774

  • Washington:
 n_total=272,000
 Sum_all=280,800
 Sum_arrestees_offenders =272,000

  • West Virginia:
 n_total=47,444
 Sum_all=51,349
 Sum_arrestees_offenders =47,444


Detailed breakdown:</code></pre>
</div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-570a4bcc{}.cl-56fa1f90{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-57004d8e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-57004d98{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-57007d72{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-57007d7c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-57007d7d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-57007d86{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-57007d90{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-57007d91{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-570a4bcc"><thead><tr style="overflow-wrap:break-word;"><th class="cl-57007d72"><p class="cl-57004d8e"><span class="cl-56fa1f90">state</span></p></th><th class="cl-57007d72"><p class="cl-57004d8e"><span class="cl-56fa1f90">n_total</span></p></th><th class="cl-57007d72"><p class="cl-57004d8e"><span class="cl-56fa1f90">n_arrestees</span></p></th><th class="cl-57007d72"><p class="cl-57004d8e"><span class="cl-56fa1f90">n_offenders</span></p></th><th class="cl-57007d72"><p class="cl-57004d8e"><span class="cl-56fa1f90">n_forensic</span></p></th><th class="cl-57007d7c"><p class="cl-57004d98"><span class="cl-56fa1f90">matches_combined_forensic</span></p></th><th class="cl-57007d7c"><p class="cl-57004d98"><span class="cl-56fa1f90">matches_combined</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Alaska</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">   79,146</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"> 52,149</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">   26,997</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  3,866</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">California</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">3,365,402</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">167,053</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Connecticut</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  127,940</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  127,940</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"> 23,200</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Georgia</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  347,145</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  324,864</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"> 22,281</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Idaho</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">   39,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">      0</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">   39,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Illinois</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  689,297</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  689,297</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"> 69,927</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Indiana</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  449,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">144,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  304,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"> 22,400</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Minnesota</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  180,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  180,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Missouri</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  400,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  386,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Montana</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">   32,284</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">      0</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">   32,284</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">    878</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">North Carolina</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  350,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"> 50,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  300,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Rhode Island</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">   27,818</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">    484</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">   27,334</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  1,798</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">South Carolina</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  175,629</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"> 11,127</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Tennessee</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  518,614</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">226,569</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  292,045</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Texas</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">1,308,774</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">1,308,774</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90"></span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">Washington</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  272,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">      0</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  272,000</span></p></td><td class="cl-57007d7d"><p class="cl-57004d8e"><span class="cl-56fa1f90">  8,800</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d86"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-57007d90"><p class="cl-57004d8e"><span class="cl-56fa1f90">West Virginia</span></p></td><td class="cl-57007d90"><p class="cl-57004d8e"><span class="cl-56fa1f90">   47,444</span></p></td><td class="cl-57007d90"><p class="cl-57004d8e"><span class="cl-56fa1f90">      0</span></p></td><td class="cl-57007d90"><p class="cl-57004d8e"><span class="cl-56fa1f90">   47,444</span></p></td><td class="cl-57007d90"><p class="cl-57004d8e"><span class="cl-56fa1f90">  3,905</span></p></td><td class="cl-57007d91"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td><td class="cl-57007d91"><p class="cl-57004d98"><span class="cl-56fa1f90">FALSE</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="analysis-of-database-totals-and-data-quality-issues" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-database-totals-and-data-quality-issues">Analysis of Database Totals and Data Quality Issues</h2>
<p>Examine states where N_total values reveal potential data quality issues or reporting inconsistencies.</p>
<div class="cell">
<details class="code-fold">
<summary>Show data quality assessment code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create enhanced data quality analysis</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sdis_enhanced <span class="ot">&lt;-</span> sdis_data <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">n_total_reported =</span> n_total)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate different total relationships with small tolerance</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>tolerance <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>sdis_enhanced <span class="ot">&lt;-</span> sdis_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_equals_offenders =</span> <span class="fu">ifelse</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(n_total_reported) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n_offenders) <span class="sc">&amp;</span> n_offenders <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(n_total_reported <span class="sc">-</span> n_offenders) <span class="sc">&lt;=</span> tolerance,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">FALSE</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_equals_off_arr =</span> <span class="fu">ifelse</span>(</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(n_total_reported) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n_offenders) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n_arrestees) <span class="sc">&amp;</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>        n_offenders <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> n_arrestees <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(n_total_reported <span class="sc">-</span> (n_offenders <span class="sc">+</span> n_arrestees)) <span class="sc">&lt;=</span> tolerance,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>      <span class="cn">FALSE</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_equals_all =</span> <span class="fu">ifelse</span>(</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(n_total_reported) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n_offenders) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(n_arrestees) <span class="sc">&amp;</span> </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!</span><span class="fu">is.na</span>(n_forensic) <span class="sc">&amp;</span> n_offenders <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> n_arrestees <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> n_forensic <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>(n_total_reported <span class="sc">-</span> (n_offenders <span class="sc">+</span> n_arrestees <span class="sc">+</span> n_forensic)) <span class="sc">&lt;=</span> tolerance,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>      <span class="cn">FALSE</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_method =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>      total_equals_all <span class="sc">~</span> <span class="st">"All components"</span>,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>      total_equals_off_arr <span class="sc">~</span> <span class="st">"Offenders + Arrestees"</span>,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>      total_equals_offenders <span class="sc">~</span> <span class="st">"Offenders only"</span>,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown"</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create n_total_estimated based on the rules specified</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>sdis_enhanced <span class="ot">&lt;-</span> sdis_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_total_estimated =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_total_estimated_comment =</span> <span class="st">""</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Rule 1: States where n_total == n_offenders + n_arrestees</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>mask_off_arr <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>total_equals_off_arr</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated[mask_off_arr] <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>n_total_reported[mask_off_arr]</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated_comment[mask_off_arr] <span class="ot">&lt;-</span> <span class="st">"Used reported total (matches offenders + arrestees)"</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Rule 2: States where n_total == n_offenders + n_arrestees + n_forensic</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>mask_all <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>total_equals_all</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated[mask_all] <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>n_total_reported[mask_all] <span class="sc">-</span> sdis_enhanced<span class="sc">$</span>n_forensic[mask_all]</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated_comment[mask_all] <span class="ot">&lt;-</span> <span class="st">"Subtracted forensic from reported total"</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Rule 3: States where n_total == n_offenders</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>mask_off_only <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>total_equals_offenders</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated[mask_off_only] <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>n_total_reported[mask_off_only]</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated_comment[mask_off_only] <span class="ot">&lt;-</span> <span class="st">"Used reported total (matches offenders only)"</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Rule 4: For remaining states with n_total</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>mask_total_only <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_total_reported) <span class="sc">&amp;</span> </span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_total_estimated) <span class="sc">&amp;</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_arrestees) <span class="sc">|</span> sdis_enhanced<span class="sc">$</span>n_arrestees <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">&amp;</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_offenders) <span class="sc">|</span> sdis_enhanced<span class="sc">$</span>n_offenders <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">&amp;</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_forensic) <span class="sc">|</span> sdis_enhanced<span class="sc">$</span>n_forensic <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated[mask_total_only] <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>n_total_reported[mask_total_only]</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated_comment[mask_total_only] <span class="ot">&lt;-</span> <span class="st">"Total only reported (no breakdown available)"</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Special case: States with n_total and n_forensic only</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>mask_total_forensic_only <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_total_reported) <span class="sc">&amp;</span> </span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_total_estimated) <span class="sc">&amp;</span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_arrestees) <span class="sc">|</span> sdis_enhanced<span class="sc">$</span>n_arrestees <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">&amp;</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_offenders) <span class="sc">|</span> sdis_enhanced<span class="sc">$</span>n_offenders <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">&amp;</span></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span><span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_forensic) <span class="sc">&amp;</span> sdis_enhanced<span class="sc">$</span>n_forensic <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated[mask_total_forensic_only] <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>n_total_reported[mask_total_forensic_only]</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated_comment[mask_total_forensic_only] <span class="ot">&lt;-</span> <span class="st">"Total only reported (forensic reported separately)"</span></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a><span class="co"># States with total and some components but unclear calculation</span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>mask_has_total_unclear <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_total_reported) <span class="sc">&amp;</span> <span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_total_estimated)</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated[mask_has_total_unclear] <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>n_total_reported[mask_has_total_unclear]</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated_comment[mask_has_total_unclear] <span class="ot">&lt;-</span> <span class="st">"Total with discrepancy (calculation unclear)"</span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a><span class="co"># For states without any total but with offenders and arrestees</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>mask_no_total <span class="ot">&lt;-</span> <span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_total_reported) <span class="sc">&amp;</span> </span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span><span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_offenders) <span class="sc">&amp;</span> sdis_enhanced<span class="sc">$</span>n_offenders <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span><span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_arrestees) <span class="sc">&amp;</span> sdis_enhanced<span class="sc">$</span>n_arrestees <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated[mask_no_total] <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>n_offenders[mask_no_total] <span class="sc">+</span> sdis_enhanced<span class="sc">$</span>n_arrestees[mask_no_total]</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated_comment[mask_no_total] <span class="ot">&lt;-</span> <span class="st">"Calculated from offenders + arrestees (no total reported)"</span></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a><span class="co"># For states without total but with only offenders &gt; 0</span></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>mask_no_total_off_only <span class="ot">&lt;-</span> <span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_total_reported) <span class="sc">&amp;</span> </span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span><span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_offenders) <span class="sc">&amp;</span> sdis_enhanced<span class="sc">$</span>n_offenders <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">is.na</span>(sdis_enhanced<span class="sc">$</span>n_arrestees) <span class="sc">|</span> sdis_enhanced<span class="sc">$</span>n_arrestees <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated[mask_no_total_off_only] <span class="ot">&lt;-</span> sdis_enhanced<span class="sc">$</span>n_offenders[mask_no_total_off_only]</span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>sdis_enhanced<span class="sc">$</span>n_total_estimated_comment[mask_no_total_off_only] <span class="ot">&lt;-</span> <span class="st">"Used offenders count (no total reported, no arrestee data)"</span></span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Create enhanced data availability matrix with better visualization</span></span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a>availability_matrix <span class="ot">&lt;-</span> sdis_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">State =</span> state,</span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">Arrestees =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(n_arrestees) <span class="sc">&amp;</span> n_arrestees <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"✓"</span>, <span class="st">"!"</span>),</span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">Offenders =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(n_offenders) <span class="sc">&amp;</span> n_offenders <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"✓"</span>, <span class="st">"!"</span>),</span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">Forensic =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(n_forensic) <span class="sc">&amp;</span> n_forensic <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"✓"</span>, <span class="st">"!"</span>),</span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Reported</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(n_total_reported), <span class="st">"✓"</span>, <span class="st">"!"</span>),</span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total Method</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a>      total_method <span class="sc">==</span> <span class="st">"Offenders only"</span> <span class="sc">~</span> <span class="st">"O"</span>,</span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a>      total_method <span class="sc">==</span> <span class="st">"Offenders + Arrestees"</span> <span class="sc">~</span> <span class="st">"O+A"</span>,</span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>      total_method <span class="sc">==</span> <span class="st">"All components"</span> <span class="sc">~</span> <span class="st">"All"</span>,</span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"?"</span></span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format for ggplot</span></span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a>availability_long <span class="ot">&lt;-</span> availability_matrix <span class="sc">%&gt;%</span></span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>State, <span class="at">names_to =</span> <span class="st">"Field"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">State =</span> <span class="fu">factor</span>(State, <span class="at">levels =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(State), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">Field =</span> <span class="fu">factor</span>(Field, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Arrestees"</span>, <span class="st">"Offenders"</span>, <span class="st">"Forensic"</span>, <span class="st">"Total Reported"</span>, <span class="st">"Total Method"</span>)),</span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create numeric values for coloring</span></span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">NumericValue =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a>      Value <span class="sc">==</span> <span class="st">"✓"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a>      Value <span class="sc">==</span> <span class="st">"!"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>      Value <span class="sc">==</span> <span class="st">"O"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a>      Value <span class="sc">==</span> <span class="st">"O+A"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a>      Value <span class="sc">==</span> <span class="st">"All"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a>      Value <span class="sc">==</span> <span class="st">"?"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create display labels</span></span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">DisplayLabel =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a>      Field <span class="sc">==</span> <span class="st">"Total Method"</span> <span class="sc">&amp;</span> Value <span class="sc">==</span> <span class="st">"?"</span> <span class="sc">~</span> <span class="st">"?"</span>,</span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a>      Field <span class="sc">==</span> <span class="st">"Total Method"</span> <span class="sc">~</span> Value,</span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> Value</span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of how n_total_estimated was calculated</span></span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"n_total_estimated Column Calculation Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"="</span>, <span class="fu">strrep</span>(<span class="st">"="</span>, <span class="dv">48</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Group states by how their n_total_estimated was determined</span></span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a>estimation_groups <span class="ot">&lt;-</span> sdis_enhanced <span class="sc">%&gt;%</span></span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n_total_estimated_comment) <span class="sc">%&gt;%</span></span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">states =</span> <span class="fu">list</span>(state),</span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary in organized sections</span></span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">1. States with n_total reported and matching patterns:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a>matching_patterns <span class="ot">&lt;-</span> estimation_groups <span class="sc">%&gt;%</span></span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"matches|Subtracted"</span>))</span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matching_patterns)) {</span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a>  group <span class="ot">&lt;-</span> matching_patterns[i, ]</span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   • %s: %d states </span><span class="sc">\n</span><span class="st">(%s)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a>              group<span class="sc">$</span>n_total_estimated_comment, </span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a>              group<span class="sc">$</span>count,</span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a>              <span class="fu">paste</span>(<span class="fu">unlist</span>(group<span class="sc">$</span>states), <span class="at">collapse =</span> <span class="st">", "</span>)))</span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">2. States with only n_total reported (no breakdown):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a>total_only <span class="ot">&lt;-</span> estimation_groups <span class="sc">%&gt;%</span></span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"Total only reported"</span>))</span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(total_only)) {</span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a>  group <span class="ot">&lt;-</span> total_only[i, ]</span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   • %s: %d states </span><span class="sc">\n</span><span class="st">(%s)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a>              group<span class="sc">$</span>n_total_estimated_comment, </span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a>              group<span class="sc">$</span>count,</span>
<span id="cb14-172"><a href="#cb14-172" aria-hidden="true" tabindex="-1"></a>              <span class="fu">paste</span>(<span class="fu">unlist</span>(group<span class="sc">$</span>states), <span class="at">collapse =</span> <span class="st">", "</span>)))</span>
<span id="cb14-173"><a href="#cb14-173" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-174"><a href="#cb14-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-175"><a href="#cb14-175" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">3. States without n_total reported (calculated):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-176"><a href="#cb14-176" aria-hidden="true" tabindex="-1"></a>calculated <span class="ot">&lt;-</span> estimation_groups <span class="sc">%&gt;%</span></span>
<span id="cb14-177"><a href="#cb14-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"Calculated|Used offenders count"</span>))</span>
<span id="cb14-178"><a href="#cb14-178" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(calculated)) {</span>
<span id="cb14-179"><a href="#cb14-179" aria-hidden="true" tabindex="-1"></a>  group <span class="ot">&lt;-</span> calculated[i, ]</span>
<span id="cb14-180"><a href="#cb14-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   • %s: %d states (%s)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb14-181"><a href="#cb14-181" aria-hidden="true" tabindex="-1"></a>              group<span class="sc">$</span>n_total_estimated_comment, </span>
<span id="cb14-182"><a href="#cb14-182" aria-hidden="true" tabindex="-1"></a>              group<span class="sc">$</span>count,</span>
<span id="cb14-183"><a href="#cb14-183" aria-hidden="true" tabindex="-1"></a>              <span class="fu">paste</span>(<span class="fu">unlist</span>(group<span class="sc">$</span>states), <span class="at">collapse =</span> <span class="st">", "</span>)))</span>
<span id="cb14-184"><a href="#cb14-184" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-185"><a href="#cb14-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-186"><a href="#cb14-186" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">4. States with unclear calculation patterns:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb14-187"><a href="#cb14-187" aria-hidden="true" tabindex="-1"></a>unclear <span class="ot">&lt;-</span> estimation_groups <span class="sc">%&gt;%</span></span>
<span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"discrepancy|unclear"</span>))</span>
<span id="cb14-189"><a href="#cb14-189" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(unclear)) {</span>
<span id="cb14-190"><a href="#cb14-190" aria-hidden="true" tabindex="-1"></a>  group <span class="ot">&lt;-</span> unclear[i, ]</span>
<span id="cb14-191"><a href="#cb14-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"   • %s: %d states (%s)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb14-192"><a href="#cb14-192" aria-hidden="true" tabindex="-1"></a>              group<span class="sc">$</span>n_total_estimated_comment, </span>
<span id="cb14-193"><a href="#cb14-193" aria-hidden="true" tabindex="-1"></a>              group<span class="sc">$</span>count,</span>
<span id="cb14-194"><a href="#cb14-194" aria-hidden="true" tabindex="-1"></a>              <span class="fu">paste</span>(<span class="fu">unlist</span>(group<span class="sc">$</span>states), <span class="at">collapse =</span> <span class="st">", "</span>)))</span>
<span id="cb14-195"><a href="#cb14-195" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-196"><a href="#cb14-196" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Show details for unclear states</span></span>
<span id="cb14-197"><a href="#cb14-197" aria-hidden="true" tabindex="-1"></a>  unclear_states <span class="ot">&lt;-</span> sdis_enhanced <span class="sc">%&gt;%</span> </span>
<span id="cb14-198"><a href="#cb14-198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(state <span class="sc">%in%</span> <span class="fu">unlist</span>(group<span class="sc">$</span>states)) <span class="sc">%&gt;%</span></span>
<span id="cb14-199"><a href="#cb14-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(state, n_total_reported, n_offenders, n_arrestees, n_forensic)</span>
<span id="cb14-200"><a href="#cb14-200" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-201"><a href="#cb14-201" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(unclear_states)) {</span>
<span id="cb14-202"><a href="#cb14-202" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> unclear_states[j, ]</span>
<span id="cb14-203"><a href="#cb14-203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"      - %s: Total=%s, Offenders=%s, Arrestees=%s, Forensic=%s</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb14-204"><a href="#cb14-204" aria-hidden="true" tabindex="-1"></a>                s<span class="sc">$</span>state, </span>
<span id="cb14-205"><a href="#cb14-205" aria-hidden="true" tabindex="-1"></a>                <span class="fu">format</span>(s<span class="sc">$</span>n_total_reported <span class="sc">%||%</span> <span class="dv">0</span>, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb14-206"><a href="#cb14-206" aria-hidden="true" tabindex="-1"></a>                <span class="fu">format</span>(s<span class="sc">$</span>n_offenders <span class="sc">%||%</span> <span class="dv">0</span>, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb14-207"><a href="#cb14-207" aria-hidden="true" tabindex="-1"></a>                <span class="fu">format</span>(s<span class="sc">$</span>n_arrestees <span class="sc">%||%</span> <span class="dv">0</span>, <span class="at">big.mark =</span> <span class="st">","</span>),</span>
<span id="cb14-208"><a href="#cb14-208" aria-hidden="true" tabindex="-1"></a>                <span class="fu">format</span>(s<span class="sc">$</span>n_forensic <span class="sc">%||%</span> <span class="dv">0</span>, <span class="at">big.mark =</span> <span class="st">","</span>)))</span>
<span id="cb14-209"><a href="#cb14-209" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-210"><a href="#cb14-210" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-211"><a href="#cb14-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-212"><a href="#cb14-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Create enhanced heatmap with legend at top and x-labels on both top and bottom</span></span>
<span id="cb14-213"><a href="#cb14-213" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(availability_long, <span class="fu">aes</span>(<span class="at">x =</span> Field, <span class="at">y =</span> State, <span class="at">fill =</span> <span class="fu">factor</span>(NumericValue))) <span class="sc">+</span></span>
<span id="cb14-214"><a href="#cb14-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">height =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb14-215"><a href="#cb14-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> DisplayLabel, <span class="at">color =</span> <span class="fu">factor</span>(NumericValue)), </span>
<span id="cb14-216"><a href="#cb14-216" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">vjust =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb14-217"><a href="#cb14-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb14-218"><a href="#cb14-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Legend"</span>,</span>
<span id="cb14-219"><a href="#cb14-219" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb14-220"><a href="#cb14-220" aria-hidden="true" tabindex="-1"></a>      <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"#FF6B6B"</span>,      <span class="co"># Red/Orange for missing/unknown</span></span>
<span id="cb14-221"><a href="#cb14-221" aria-hidden="true" tabindex="-1"></a>      <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#2E86AB"</span>,      <span class="co"># Blue for available</span></span>
<span id="cb14-222"><a href="#cb14-222" aria-hidden="true" tabindex="-1"></a>      <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"#4ECDC4"</span>,      <span class="co"># Teal for Offenders only</span></span>
<span id="cb14-223"><a href="#cb14-223" aria-hidden="true" tabindex="-1"></a>      <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"#45B7D1"</span>,      <span class="co"># Light blue for Offenders + Arrestees</span></span>
<span id="cb14-224"><a href="#cb14-224" aria-hidden="true" tabindex="-1"></a>      <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"#1A535C"</span>       <span class="co"># Dark teal for All components</span></span>
<span id="cb14-225"><a href="#cb14-225" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-226"><a href="#cb14-226" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb14-227"><a href="#cb14-227" aria-hidden="true" tabindex="-1"></a>      <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"Missing/Unknown data"</span>,</span>
<span id="cb14-228"><a href="#cb14-228" aria-hidden="true" tabindex="-1"></a>      <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Data available"</span>,</span>
<span id="cb14-229"><a href="#cb14-229" aria-hidden="true" tabindex="-1"></a>      <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Total = Offenders only"</span>,</span>
<span id="cb14-230"><a href="#cb14-230" aria-hidden="true" tabindex="-1"></a>      <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Total = Offenders + Arrestees"</span>,</span>
<span id="cb14-231"><a href="#cb14-231" aria-hidden="true" tabindex="-1"></a>      <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Total = All components"</span></span>
<span id="cb14-232"><a href="#cb14-232" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-233"><a href="#cb14-233" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-234"><a href="#cb14-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb14-235"><a href="#cb14-235" aria-hidden="true" tabindex="-1"></a>    <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"white"</span>,        <span class="co"># White text on red</span></span>
<span id="cb14-236"><a href="#cb14-236" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"white"</span>,        <span class="co"># White text on blue</span></span>
<span id="cb14-237"><a href="#cb14-237" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"white"</span>,        <span class="co"># White text on teal</span></span>
<span id="cb14-238"><a href="#cb14-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"white"</span>,        <span class="co"># White text on light blue</span></span>
<span id="cb14-239"><a href="#cb14-239" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"white"</span>         <span class="co"># White text on dark teal</span></span>
<span id="cb14-240"><a href="#cb14-240" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb14-241"><a href="#cb14-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-242"><a href="#cb14-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Data Field Availability and Total Calculation Method"</span>,</span>
<span id="cb14-243"><a href="#cb14-243" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"✓ = Available | ! = Missing | O = Offenders only | O+A = Offenders + Arrestees | All = All components"</span>,</span>
<span id="cb14-244"><a href="#cb14-244" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb14-245"><a href="#cb14-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb14-246"><a href="#cb14-246" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-247"><a href="#cb14-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb14-248"><a href="#cb14-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-249"><a href="#cb14-249" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb14-250"><a href="#cb14-250" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x.top =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb14-251"><a href="#cb14-251" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb14-252"><a href="#cb14-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb14-253"><a href="#cb14-253" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb14-254"><a href="#cb14-254" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-255"><a href="#cb14-255" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb14-256"><a href="#cb14-256" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb14-257"><a href="#cb14-257" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb14-258"><a href="#cb14-258" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(),</span>
<span id="cb14-259"><a href="#cb14-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x.top =</span> <span class="fu">element_line</span>()</span>
<span id="cb14-260"><a href="#cb14-260" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-261"><a href="#cb14-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb14-262"><a href="#cb14-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb14-263"><a href="#cb14-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">position =</span> <span class="st">"top"</span>)</span>
<span id="cb14-264"><a href="#cb14-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-265"><a href="#cb14-265" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the main dataframe for subsequent analyses</span></span>
<span id="cb14-266"><a href="#cb14-266" aria-hidden="true" tabindex="-1"></a>sdis_data <span class="ot">&lt;-</span> sdis_enhanced</span>
<span id="cb14-267"><a href="#cb14-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-268"><a href="#cb14-268" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for null coalescing</span></span>
<span id="cb14-269"><a href="#cb14-269" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">%||%</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b) <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(a) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(a)) a <span class="cf">else</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>n_total_estimated Column Calculation Summary:
=================================================

1. States with n_total reported and matching patterns:
   • Used reported total (matches offenders only): 8 states 
(Connecticut, Idaho, Illinois, Minnesota, Montana, Texas, Washington, West Virginia)
   • Used reported total (matches offenders + arrestees): 4 states 
(Alaska, North Carolina, Rhode Island, Tennessee)

2. States with only n_total reported (no breakdown):
   • Total only reported (no breakdown available): 10 states 
(Alabama, Arkansas, Colorado, Florida, Louisiana, Mississippi, Nevada, New Jersey, South Dakota, Virginia)
   • Total only reported (forensic reported separately): 2 states 
(California, South Carolina)

3. States without n_total reported (calculated):
   • Calculated from offenders + arrestees (no total reported): 1 states (Maryland)

4. States with unclear calculation patterns:
   • Total with discrepancy (calculation unclear): 3 states (Georgia, Indiana, Missouri)
      - Georgia: Total=347,145, Offenders=324,864, Arrestees=NA, Forensic=22,281
      - Indiana: Total=449,000, Offenders=304,000, Arrestees=144,000, Forensic=22,400
      - Missouri: Total=4e+05, Offenders=386,000, Arrestees=NA, Forensic=NA</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sdis_summary_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show summary visualization code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> sdis_data <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"matches offenders only"</span>) <span class="sc">~</span> <span class="st">"Matches Offenders Only"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"matches offenders </span><span class="sc">\\</span><span class="st">+ arrestees"</span>) <span class="sc">~</span> <span class="st">"Matches Offenders + Arrestees"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"Total only reported </span><span class="sc">\\</span><span class="st">(no breakdown</span><span class="sc">\\</span><span class="st">)"</span>) <span class="sc">~</span> <span class="st">"Total Only (No Breakdown)"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"Total only reported </span><span class="sc">\\</span><span class="st">(forensic"</span>) <span class="sc">~</span> <span class="st">"Total Only (Forensic Separate)"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"Calculated from offenders </span><span class="sc">\\</span><span class="st">+ arrestees"</span>) <span class="sc">~</span> <span class="st">"Calculated (Offenders + Arrestees)"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"Used offenders count"</span>) <span class="sc">~</span> <span class="st">"Calculated (Offenders Only)"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(n_total_estimated_comment, <span class="st">"discrepancy|unclear"</span>) <span class="sc">~</span> <span class="st">"Unclear Calculation"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_arrestees =</span> <span class="sc">!</span><span class="fu">is.na</span>(n_arrestees) <span class="sc">&amp;</span> n_arrestees <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_offenders =</span> <span class="sc">!</span><span class="fu">is.na</span>(n_offenders) <span class="sc">&amp;</span> n_offenders <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_forensic =</span> <span class="sc">!</span><span class="fu">is.na</span>(n_forensic) <span class="sc">&amp;</span> n_forensic <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_total_reported =</span> <span class="sc">!</span><span class="fu">is.na</span>(n_total_reported)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary table by category</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>category_summary <span class="ot">&lt;-</span> summary_data <span class="sc">%&gt;%</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data_category) <span class="sc">%&gt;%</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">states =</span> <span class="fu">paste</span>(<span class="fu">sort</span>(state), <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_total =</span> <span class="fu">mean</span>(n_total_estimated, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_total =</span> <span class="fu">median</span>(n_total_estimated, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SUMMARY STATISTICS</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=================</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Calculation Methods Distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(category_summary)) {</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">%s: %d states (%s)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>              category_summary<span class="sc">$</span>data_category[i], </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>              category_summary<span class="sc">$</span>count[i],</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>              category_summary<span class="sc">$</span>states[i]))</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Overall Data Availability:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"States with arrestee data: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">sum</span>(summary_data<span class="sc">$</span>has_arrestees)))</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"States with offender data: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">sum</span>(summary_data<span class="sc">$</span>has_offenders)))</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"States with forensic data: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">sum</span>(summary_data<span class="sc">$</span>has_forensic)))</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"States with total reported: %d</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">sum</span>(summary_data<span class="sc">$</span>has_total_reported)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>SUMMARY STATISTICS
=================

Calculation Methods Distribution:

Other: 32 states (Alabama, Arizona, Arkansas, Colorado, Delaware, Florida, Hawaii, Iowa, Kansas, Kentucky, Louisiana, Maine, Massachusetts, Michigan, Mississippi, Nebraska, Nevada, New Hampshire, New Jersey, New Mexico, New York, North Dakota, Ohio, Oklahoma, Oregon, Pennsylvania, South Dakota, Utah, Vermont, Virginia, Wisconsin, Wyoming)

Matches Offenders Only: 8 states (Connecticut, Idaho, Illinois, Minnesota, Montana, Texas, Washington, West Virginia)

Matches Offenders + Arrestees: 4 states (Alaska, North Carolina, Rhode Island, Tennessee)

Unclear Calculation: 3 states (Georgia, Indiana, Missouri)

Total Only (Forensic Separate): 2 states (California, South Carolina)

Calculated (Offenders + Arrestees): 1 states (Maryland)

Overall Data Availability:
States with arrestee data: 6
States with offender data: 16
States with forensic data: 11
States with total reported: 27</code></pre>
</div>
</div>
</section>
<section id="export-enhanced-dataset" class="level2">
<h2 class="anchored" data-anchor-id="export-enhanced-dataset">Export Enhanced Dataset</h2>
<p>Export the enhanced dataset with the new n_total_estimated values and documentation.</p>
<div class="cell">
<details class="code-fold">
<summary>Show exportation code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare final dataset with key columns in logical order</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>final_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'state'</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'n_total_estimated'</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'n_total_reported'</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'n_arrestees'</span>, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'n_offenders'</span>, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'n_forensic'</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">'fam_search'</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">'collection_statute'</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">'n_total_estimated_comment'</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">'total_method'</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Select columns that exist in the dataset</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>available_columns <span class="ot">&lt;-</span> <span class="fu">intersect</span>(final_columns, <span class="fu">names</span>(sdis_enhanced))</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>sdis_final <span class="ot">&lt;-</span> sdis_enhanced <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(available_columns))</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Export to CSV</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>output_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"sdis"</span>, <span class="st">"sdis_clean.csv"</span>))</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(sdis_final, output_path)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Exported enhanced SDIS dataset to:"</span>, output_path, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display final summary statistics</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Final Summary Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"="</span>, <span class="fu">strrep</span>(<span class="st">"="</span>, <span class="dv">48</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Total states in dataset:"</span>, <span class="fu">nrow</span>(sdis_final), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"States with n_total_estimated:"</span>, <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(sdis_final<span class="sc">$</span>n_total_estimated)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"States with n_total_reported:"</span>, <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(sdis_final<span class="sc">$</span>n_total_reported)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Total profiles (estimated):"</span>, <span class="fu">format</span>(<span class="fu">sum</span>(sdis_final<span class="sc">$</span>n_total_estimated, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data for the interactive table</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> sdis_data <span class="sc">%&gt;%</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, n_total_estimated, n_total_reported, n_offenders, n_arrestees, </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>         n_forensic, n_total_estimated_comment) <span class="sc">%&gt;%</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="cn">NA</span>, <span class="fu">format</span>(., <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>))))</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interactive table</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  summary_table,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'ColReorder'</span>, <span class="st">'Scroller'</span>),</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'colvis'</span>),</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollY =</span> <span class="st">"600px"</span>,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">scroller =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">20</span>,</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-right'</span>, <span class="at">targets =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),  <span class="co"># Right-align numeric columns</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-left'</span>, <span class="at">targets =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>))  <span class="co"># Left-align state and comment columns</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">'top'</span>,</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Enhanced Data with Estimated Totals"</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Exported enhanced SDIS dataset to: C:/Users/Donadio/Documents/PODFRIDGE-3/PODFRIDGE-Databases/output/sdis/sdis_clean.csv 


Final Summary Statistics:
=================================================
Total states in dataset: 50 
States with n_total_estimated: 28 
States with n_total_reported: 27 
Total profiles (estimated): 12,814,222 </code></pre>
</div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-4ca4f5b5faa73d2c2fc8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4ca4f5b5faa73d2c2fc8">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"caption":"<caption>Enhanced Data with Estimated Totals<\/caption>","data":[["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],["  360,000","   79,146",null,"   12,221","3,365,402","  499,170","  127,940",null,"1,713,890","  347,145",null,"   39,000","  689,297","  449,000",null,null,null,"  699,618",null,"  147,803",null,null,"  180,000","  118,000","  400,000","   32,284",null,"  245,000",null,"   32,696",null,null,"  350,000",null,null,null,null,null,"   27,818","  175,629","   56,200","  518,614","1,308,774",null,null,"  520,131","  272,000","   47,444",null,null],["  360,000","   79,146",null,"   12,221","3,365,402","  499,170","  127,940",null,"1,713,890","  347,145",null,"   39,000","  689,297","  449,000",null,null,null,"  699,618",null,null,null,null,"  180,000","  118,000","  400,000","   32,284",null,"  245,000",null,"   32,696",null,null,"  350,000",null,null,null,null,null,"   27,818","  175,629","   56,200","  518,614","1,308,774",null,null,"  520,131","  272,000","   47,444",null,null],[null,"   26,997",null,null,null,null,"  127,940",null,null,"  324,864",null,"   39,000","  689,297","  304,000",null,null,null,null,null,"  142,278",null,null,"  180,000",null,"  386,000","   32,284",null,null,null,null,null,null,"  300,000",null,null,null,null,null,"   27,334",null,null,"  292,045","1,308,774",null,null,null,"  272,000","   47,444",null,null],[null," 52,149",null,null,null,null,null,"      0",null,null,"      0","      0",null,"144,000","      0",null,"      0",null,"      0","  5,525","      0",null,null,null,null,"      0","      0",null,"      0",null,null,"      0"," 50,000",null,null,null,"      0","      0","    484",null,null,"226,569",null,null,"      0",null,"      0","      0",null,"      0"],[null,"  3,866",null,null,"167,053",null," 23,200",null,null," 22,281",null,null," 69,927"," 22,400",null,null,null,null,null,null,null,null,null,null,null,"    878",null,null,null,null,null,null,null,null,null,null,null,null,"  1,798"," 11,127",null,null,null,null,null,null,"  8,800","  3,905",null,null],["Total only reported (no breakdown available)","Used reported total (matches offenders + arrestees)","","Total only reported (no breakdown available)","Total only reported (forensic reported separately)","Total only reported (no breakdown available)","Used reported total (matches offenders only)","","Total only reported (no breakdown available)","Total with discrepancy (calculation unclear)","","Used reported total (matches offenders only)","Used reported total (matches offenders only)","Total with discrepancy (calculation unclear)","","","","Total only reported (no breakdown available)","","Calculated from offenders + arrestees (no total reported)","","","Used reported total (matches offenders only)","Total only reported (no breakdown available)","Total with discrepancy (calculation unclear)","Used reported total (matches offenders only)","","Total only reported (no breakdown available)","","Total only reported (no breakdown available)","","","Used reported total (matches offenders + arrestees)","","","","","","Used reported total (matches offenders + arrestees)","Total only reported (forensic reported separately)","Total only reported (no breakdown available)","Used reported total (matches offenders + arrestees)","Used reported total (matches offenders only)","","","Total only reported (no breakdown available)","Used reported total (matches offenders only)","Used reported total (matches offenders only)","",""]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>state<\/th>\n      <th>n_total_estimated<\/th>\n      <th>n_total_reported<\/th>\n      <th>n_offenders<\/th>\n      <th>n_arrestees<\/th>\n      <th>n_forensic<\/th>\n      <th>n_total_estimated_comment<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","colvis"],"scrollX":true,"scrollY":"600px","scroller":true,"pageLength":20,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"className":"dt-left","targets":[0,6]},{"name":"state","targets":0},{"name":"n_total_estimated","targets":1},{"name":"n_total_reported","targets":2},{"name":"n_offenders","targets":3},{"name":"n_arrestees","targets":4},{"name":"n_forensic","targets":5},{"name":"n_total_estimated_comment","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>